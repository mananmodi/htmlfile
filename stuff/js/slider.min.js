(function(g){function a(o){var n=o.data("baseParams");var p=n.btn.position().left-n.bar.position().left;o.find(".slider-bar-bar").width(p+n.btnOffset)}function j(o){var n=o.data("baseParams");var p=n.btn.position().left-n.bar.position().left;var q=n.sliderParams.total/o.find(".slider-bar-container").outerWidth();o.data("baseParams").total=Math.round((p+20)*q);var s=o.data("baseParams").total;var r=n.sliderParams.symbol=="none"?b(s):n.sliderParams.symbol+b(s);o.trigger("sliderTotal",{amount:r,id:o})}function c(o){var n=o.data("baseParams");o.data("baseParams").points=(n.total*Number(n.sliderParams.point))*n.sliderParams.multiplier;var p=b(n.points);o.trigger("sliderPoints",{pts:p,id:o})}function b(n){n=String(n).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");return n}function l(n){var o=n.data;e(o.id)}function e(q){var p=q.data("baseParams");p.btnOffset=(p.btn.outerWidth()/2);var o=p.bar.offset().left-p.btnOffset;var n=p.bar.offset().left+(p.bar.outerWidth()-p.btnOffset);p.btn.draggable({containment:[o,0,n,0],axis:"x",cursor:"pointer"})}function h(p,n){var o=p.data("baseParams");p.data("baseParams").points=0;o.doc=g(document);o.bar=p.find(".slider-bar-container");o.btn=p.find(".slider-bar-btn");var q=o.sliderParams.symbol=="none"?"0":o.sliderParams.symbol+"0";p.find(".slider-content-amount").html(q);p.find(".pts-total-amount").html(o.points);e(p);d();n.call()}function i(n){var o=n.data;a(o.id);j(o.id);c(o.id)}function m(n){var o=n.data;k(o)}function k(o){var n=o.id.data("baseParams");a(o.id);j(o.id);c(o.id);o.id.trigger("sliderMenu",{pts:n.points,id:o.id})}g.fn.slider=function(p){var o=this;o.data("baseParams",{sliderParams:"",bar:"",btn:"",btnOffset:"",total:"",points:""});var n=o.data("baseParams");n.sliderParams=g.extend({total:"100",symbol:"none",point:"1",multiplier:"1"},p);h(this,function(){o.bind("mouseup.slider",{id:o},m);n.btn.bind("drag.slider",{id:o},i);g(window).bind("resize.slider",{id:o},l)});return o};function f(q){var n=g(q.target);if(n.hasClass("slider-bar-btn")){var r=q.changedTouches,s=r[0],o="";switch(q.type){case"touchstart":o="mousedown";break;case"touchmove":o="mousemove";break;case"touchend":o="mouseup";break;default:return}var p=document.createEvent("MouseEvent");p.initMouseEvent(o,true,true,window,1,s.screenX,s.screenY,s.clientX,s.clientY,false,false,false,false,0,null);s.target.dispatchEvent(p);q.preventDefault()}}function d(){var o=navigator.userAgent.toLowerCase();var n=o.match(/(iphone|ipod|ipad)/);if(n){document.addEventListener("touchstart",f,true);document.addEventListener("touchmove",f,true);document.addEventListener("touchend",f,true);document.addEventListener("touchcancel",f,true)}}})(jQuery);